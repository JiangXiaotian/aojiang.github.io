<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>文件预览器 - LFS.baby</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
            color: #333;
        }
        .description {
            text-align: center;
            margin-bottom: 20px;
            color: #666;
        }
        .file-row {
            display: flex;
            margin-bottom: 15px;
            border-bottom: 1px solid #eee;
            padding-bottom: 15px;
        }
        .file-cell {
            flex: 1;
            padding: 10px;
            margin: 0 5px;
            background-color: #f9f9f9;
            border-radius: 4px;
        }
        .file-name {
            font-weight: bold;
            margin-bottom: 5px;
        }
        img {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 0 auto;
        }
        .text-content {
            white-space: pre-wrap;
            overflow-x: auto;
            max-height: 200px;
            overflow-y: auto;
            padding: 8px;
            background-color: #fff;
            border: 1px solid #eee;
            border-radius: 4px;
        }
        video {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 0 auto;
        }
        .no-files {
            text-align: center;
            padding: 20px;
            color: #666;
            font-style: italic;
        }
        .file-list {
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>文件对齐预览器</h1>
        <p class="description">
            本页面展示同名的图片、文本和视频文件。文件存储在GitHub仓库中的assets目录下。
        </p>
        
        <div id="file-list" class="file-list"></div>
    </div>

    <script>
        // 基础目录路径
        const basePath = '/assets';
        const imageDir = `${basePath}/images`;
        const textDir = `${basePath}/texts`;
        const videoDir = `${basePath}/videos`;
        
        // 文件列表 - 这里需要手动更新或从文件中读取
        // 在实际使用中，您需要在每次添加新文件后更新这个列表
        const fileNames = [
            '1', '2', '3', '4', '5'
            // 添加更多文件名...
        ];
        
        // 支持的文件扩展名
        const imageExts = ['.jpg', '.jpeg', '.png', '.gif', '.webp'];
        const textExts = ['.txt', '.md', '.json', '.csv'];
        const videoExts = ['.mp4', '.webm', '.ogg', '.mov'];
        
        // 文件格式检测函数
        function getImageExt(baseName) {
            return imageExts.find(ext => fileExists(`${imageDir}/${baseName}${ext}`)) || null;
        }
        
        function getTextExt(baseName) {
            return textExts.find(ext => fileExists(`${textDir}/${baseName}${ext}`)) || null;
        }
        
        function getVideoExt(baseName) {
            return videoExts.find(ext => fileExists(`${videoDir}/${baseName}${ext}`)) || null;
        }
        
        // 简单的文件存在检测（仅用于简化示例，实际上这只能在服务器端进行）
        // 在GitHub Pages中，我们假设文件存在并尝试加载
        function fileExists(path) {
            // 在纯静态环境中无法真正检查文件是否存在
            // 这里我们总是返回true，实际显示时会处理加载失败的情况
            return true;
        }
        
        // 初始化页面
        function initPage() {
            const fileListElement = document.getElementById('file-list');
            
            if (fileNames.length === 0) {
                fileListElement.innerHTML = '<div class="no-files">没有找到文件</div>';
                return;
            }
            
            fileNames.forEach(baseName => {
                const row = document.createElement('div');
                row.className = 'file-row';
                
                // 图片单元格
                const imageCell = createImageCell(baseName);
                row.appendChild(imageCell);
                
                // 文本单元格
                const textCell = createTextCell(baseName);
                row.appendChild(textCell);
                
                // 视频单元格
                const videoCell = createVideoCell(baseName);
                row.appendChild(videoCell);
                
                fileListElement.appendChild(row);
            });
        }
        
        // 创建图片单元格
        function createImageCell(baseName) {
            const cell = document.createElement('div');
            cell.className = 'file-cell';
            
            // 我们尝试所有可能的扩展名
            const possibleExts = imageExts.slice();
            
            const fileNameHeader = document.createElement('div');
            fileNameHeader.className = 'file-name';
            fileNameHeader.textContent = `${baseName}.*`;
            
            const img = document.createElement('img');
            
            // 尝试加载第一个扩展名
            loadImageWithFallback(img, baseName, possibleExts, 0);
            
            cell.appendChild(fileNameHeader);
            cell.appendChild(img);
            
            return cell;
        }
        
        // 递归尝试不同扩展名的图片
        function loadImageWithFallback(imgElement, baseName, extensions, index) {
            if (index >= extensions.length) {
                // 所有扩展名都尝试失败，显示占位符
                imgElement.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2VlZSIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMjAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGRvbWluYW50LWJhc2VsaW5lPSJtaWRkbGUiIGZpbGw9IiM5OTkiPuWbvueJh+aXoOazlOaYvuekujwvdGV4dD48L3N2Zz4=';
                return;
            }
            
            const ext = extensions[index];
            const src = `${imageDir}/${baseName}${ext}`;
            
            imgElement.onerror = function() {
                // 当前扩展名加载失败，尝试下一个
                loadImageWithFallback(imgElement, baseName, extensions, index + 1);
            };
            
            imgElement.src = src;
            imgElement.alt = `${baseName}${ext}`;
        }
        
        // 创建文本单元格
        function createTextCell(baseName) {
            const cell = document.createElement('div');
            cell.className = 'file-cell';
            
            // 我们尝试所有可能的扩展名
            const possibleExts = textExts.slice();
            
            const fileNameHeader = document.createElement('div');
            fileNameHeader.className = 'file-name';
            fileNameHeader.textContent = `${baseName}.*`;
            
            const textContent = document.createElement('div');
            textContent.className = 'text-content';
            textContent.textContent = '加载中...';
            
            cell.appendChild(fileNameHeader);
            cell.appendChild(textContent);
            
            // 尝试加载第一个扩展名
            loadTextWithFallback(textContent, baseName, possibleExts, 0);
            
            return cell;
        }
        
        // 递归尝试不同扩展名的文本
        function loadTextWithFallback(textElement, baseName, extensions, index) {
            if (index >= extensions.length) {
                // 所有扩展名都尝试失败
                textElement.textContent = '未找到文本文件';
                return;
            }
            
            const ext = extensions[index];
            const src = `${textDir}/${baseName}${ext}`;
            
            fetch(src)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('文件不存在');
                    }
                    return response.text();
                })
                .then(content => {
                    textElement.textContent = content;
                })
                .catch(error => {
                    // 当前扩展名加载失败，尝试下一个
                    loadTextWithFallback(textElement, baseName, extensions, index + 1);
                });
        }
        
        // 创建视频单元格
        function createVideoCell(baseName) {
            const cell = document.createElement('div');
            cell.className = 'file-cell';
            
            // 我们尝试所有可能的扩展名
            const possibleExts = videoExts.slice();
            
            const fileNameHeader = document.createElement('div');
            fileNameHeader.className = 'file-name';
            fileNameHeader.textContent = `${baseName}.*`;
            
            cell.appendChild(fileNameHeader);
            
            // 尝试加载第一个扩展名
            loadVideoWithFallback(cell, baseName, possibleExts, 0);
            
            return cell;
        }
        
        // 递归尝试不同扩展名的视频
        function loadVideoWithFallback(cellElement, baseName, extensions, index) {
            if (index >= extensions.length) {
                // 所有扩展名都尝试失败
                const message = document.createElement('div');
                message.textContent = '未找到视频文件';
                cellElement.appendChild(message);
                return;
            }
            
            const ext = extensions[index];
            const src = `${videoDir}/${baseName}${ext}`;
            
            const video = document.createElement('video');
            video.controls = true;
            video.preload = 'metadata';
            
            video.onerror = function() {
                cellElement.removeChild(video);
                // 当前扩展名加载失败，尝试下一个
                loadVideoWithFallback(cellElement, baseName, extensions, index + 1);
            };
            
            video.src = src;
            cellElement.appendChild(video);
        }
        
        // 页面加载时初始化
        window.onload = initPage;
    </script>
</body>
</html> 